= Design Patterns - TP 1
J.-M. Bruel <jbruel@gmail.com>
v20.1 {localdate}
:uk:
:imagesdir: images
//------------------------- variables de configuration
// only used when master document
:icons: font
:experimental:
:numbered!:
:status:
:baseURL: https://github.com/LP-APSIO/MobileModeling2020
:github: https://github.com[GitHub]
// Specific to GitHub
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:

endif::[]
//------------------------------------ 
ifdef::uk[]
:lastName: LAST NAME
:firstName: First Name
:group: Group
:example: Example
:Enseignants: Teachers
:principe: Principe Objet
:allerPlusLoin: Still hungry?
endif::[]
ifndef::uk[]
:lastName: NOM
:firstName: Prénom
:group: Groupe
:example: Exemple
:Enseignants: Enseignants
:principe: Good design principle
:allerPlusLoin: Pur aller plus loin...
endif::[]
//------------------------------------ 

TD1 initial code.
This is a template for the students' assignments.

//------------------------------------ 
== Assignment info

{lastName}:: BRUEL

{firstName}:: Jean-Michel

Group #::

[%interactive]
- [x] {Enseignants}
- [ ] 1
- [ ] 2
- [ ] 3
- [ ] 4
- [ ] Innopolis

//------------------------------------ 
== Requirements

You'll need:

[%interactive]
* [x] A {Github} account  
* [ ] A https://gitforwindows.org/[Git Bash] terminal (if you use Window$)

[TIP]
====    
Try the following command in your terminal to check your `git` environment:

[source,shell]
....
git config --global -l
....
====

//------------------------------------ 
== Initial tasks

[%interactive]
* [x] Click on the Github Classroom link provided by your teacher (in fact, this should be done if you read this).
* [ ] Clone on your machine the Github project generated by Github Classroom.  
* [ ] Modify the README file to add your last name, first name and group number. 
* [ ] Commit and push using the following message:

ifndef::backend-pdf[.pass:[<i class="fa fa-github"></i>] commit/push]
ifdef::backend-pdf[.icon:github[] commit/push]
[source,shell]
....
fix 0 Initial task done
....

[IMPORTANT]
ifndef::uk[]
Dans la suite de ce document, à chaque fois que vous trouverez un énoncé commençant par `fix ...` vous devez vérifier que vos scripts/fichiers modifiés sont bien dans votre dépôt local en vue de committer et de pusher les modifications sur votre dépôt distant en utilisant comme message de commit cet énoncé.
endif::[]
ifdef::uk[]
In the following, every time you'll see à `fix ...` text, 
make sure all your files are committed, and then push your modifications in the distant repo, making sure you used the corresponding message (`fix ...`) in one of the `commit` messages.
endif::[]

[TIP]
====
- If you want to check that you're really ready for `fix 0`, you can run the command in your shell: `make check`.
- If you want to list the ToDos of the day, run `make todos`.
====


:numbered:
//------------------------------------ 
== The Adventure game

=== Basics

. Using _Strategy_, and using the package organization provided at <<setWeapon,the end of this doc>>,, 
write the classes and behaviors of the adventure game of TD1 (section 1.7.2):
+
.Minimal adventure game
image::aventure.svg[link="images/aventure.svg"]


[INFO]
=====
As this is your own code, please write your Classes in English:

.Translations French/English/Russian
[options="header,footer"]
|===============================================
| FR 					|  US     			| RU
| Personnage    		|  Character   		| Персонаж
| Reine     			|  Queen   			| Королева
| Roi     				|  King 			| Король
| Troll    				|  Troll   			| Тролль
| Chevalier    			|  Knight   		| Рыцарь
| ComportementArme    	|  BehaviorWeapon   | ВладениеОружием
| ComportementPoignard	|  BehaviorKnife   	| ВладениеНожом
| ComportementArc    	|  BehaviorBow   	| ВладениеЛуком
| ComportementEpee    	|  BehaviorSword   	| ВладениеМечом
| tirer()    		    |  fight()   		| сражаться()
| setArme()    			|  setWeapon()		| установитьОружие()
| utiliserArme()    	|  useWeapon()		| использоватьОружие()
|===============================================

=====

ifndef::backend-pdf[.pass:[<i class="fa fa-github"></i>] commit/push]
ifdef::backend-pdf[.icon:github[] commit/push]
[source,shell]
....
fix 1.1: Initial Adventure Game
....


=== Improvements

We want to force any designer of a new `Character` to systematically decide the weapon behavior at the instantiation time.

. Propose a solution to this problem.
+
TIP: it is perfectly authorized to create a constructor for an abstract class...
+
. Try this solution by modifying your application
+
ifndef::backend-pdf[.pass:[<i class="fa fa-github"></i>] commit/push]
ifdef::backend-pdf[.icon:github[] commit/push]
[source,shell]
....
fix 1.2.2: Initial Adventure Game
....
+
. Test to add a new `Character` concrete class who does not apply with this new regulation and see that it does not compile.
+
ifndef::backend-pdf[.pass:[<i class="fa fa-github"></i>] commit/push]
ifdef::backend-pdf[.icon:github[] commit/push]
[source,shell]
....
fix 1.2.3: Initial Adventure Game
....


=== Dynamic Behavior

Let's experiment how it is possible now to change at runtime.

. Write an app where, from a menu, you can create a `Character` by selecting a type, 
and you can then select his/her weapon.
. Check that, when you change the weapon, the associated behavior change too.

ifndef::backend-pdf[.pass:[<i class="fa fa-github"></i>] commit/push]
ifdef::backend-pdf[.icon:github[] commit/push]
[source,shell]
....
fix 1.3: Dynamic Behavior
....

=== _Reverse engineering_ of the code

You have to provide the final class diagram of your application.
You can use any valuable technique to get this diagram:

- Here is an `ant` example:
+
.Example of an `ant` file
[source,ant]
----
include::util/build.xml[]
----
+
- Here is a Windows script example:
+
.Example of a `.BAT` file
[source,shell]
----
set UML=TD1.uml
set TYPE='PNG'
set DOCLETPATH=
echo "Creating %UML%..."

javadoc -J-DdestinationFile=%UML% -J-DcreatePackages=false
-J-DshowPublicMethods=true -J-DshowPublicConstructors=false
-J-DshowPublicFields=true -doclet de.mallox.doclet.PlantUMLDoclet
-docletpath plantUmlDoclet.jar src/appli/*.java
src/behaviors/weapon/*.java src/behaviors/weapon/impl/*.java
src/Characters/*.java
echo "Done."

set TYPE='png'
echo "Converting %UML% to $TYPE..."
java -jar plantuml.jar -config "config.cfg" -t %TYPE% %UML%
echo "Done."
----
+
- There is a new doclet available: https://github.com/gboersma/uml-java-doclet
- Directly get the code from an eclipse plugin
menu:Window[Show View > Other... > PlantUML > PlantUML Source].

//----------------------------- Question ------------------
.*TODO*:
[WARNING]
====
[%interactive]
* [ ] Place the resulting plantUML version of your diagram in a `doc` folder at the root of your repo, with the exact name: `TP1.plantuml`
* [ ] When everything is OK, push your code:
+
ifndef::backend-pdf[.pass:[<i class="fa fa-github"></i>] commit/push]
ifdef::backend-pdf[.icon:github[] commit/push]
[source,shell]
....
fix 1.4: Final TP1 commit
....
+
* [ ] Check your autograding on your repo
====

[TIP]
====
The autograding will use the `tests/checkModel.rb` ruby file. 
For example, when applied to the following model:

.`TP1.plantuml` graphical version (source: tests/[TP1.plantuml])
image::TP1.svg[]

the test (the one dedicated to `SuperCanard`, in `tests/checkSuperCanardModel.rb`) will provide the following result:

.Check result for `TP1.plantuml`
image::TP1-check.png[]
====

:numbered!:
[appendix]
[[setWeapon]]

== Example of a package organization (taken from `SuperCanard`):

[source,shell]
-------
        ├── appli
        │   ├── Canard.java
        │   ├── CanardEnPlastique.java
        │   ├── Colvert.java
        │   ├── Leurre.java
        │   ├── Main.java
        │   └── Mandarin.java
        └── behaviors
            ├── cancaner
            │   ├── BehaviorCancan.java
            │   └── impl
            │       ├── CanardMuet.java
            │       ├── Cancan.java
            │       └── Coincoin.java
            └── voler
                ├── BehaviorVol.java
                └── impl
                    ├── NePasVoler.java
                    └── VolerAvecDesAiles.java
-------

[appendix]
== {allerPlusLoin}

. Test the limits of your implementation (for example what happens if someone does `new Knight(null,null)` ?).
. Propose some tests in the same way `testfix1.1` was testing the commits in `TD1`.

ifndef::backend-pdf[.pass:[<i class="fa fa-github"></i>] commit/push]
ifdef::backend-pdf[.icon:github[] commit/push]
[source,shell]
....
fix 1.5: Give me a bonus I did: [please explain]
....





ifndef::compact[]
//------------------------------------ 
== Contributors
//------------------------------------ 

- mailto:jbruel@gmail.com[Jean-Michel Bruel]

== About...

****************************************************************
Document réalisé via  {asciidoctorlink} (version `{asciidoctor-version}`) de 'Dan Allen', lui même basé sur {asciidoc}.
Libre d'utilisation et géré par la 'Licence Creative Commons'.
image:88x31.png["Licence Creative
Commons",style="border-width:0",link="http://creativecommons.org/licenses/by-sa/3.0/"]
http://creativecommons.org/licenses/by-sa/3.0/[licence Creative Commons Paternité - Partage à l&#39;Identique 3.0 non transposé].
****************************************************************
endif::compact[]
